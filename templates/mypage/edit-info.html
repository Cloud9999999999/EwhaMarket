<!--마이페이지 두 번째 화면-->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ewha Market</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles/global.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles/mypage.css') }}"
    />
  </head>
  <body>
    <header>
       <div class="logo">
        <a href="{{ url_for('home') }}">
          <img
            src="{{ url_for('static', filename='image/Market-logo.png') }}"
            alt="Ewha Market"
            class="logo"
          />
        </a>
      </div>
      <nav>
        <ul class="nav-menu">
          <li><a href="{{ url_for('home') }}">상품 조회</a></li>
          <li><a href="{{ url_for('reviews_index') }}">리뷰 조회</a></li>
          <li><a href="{{ url_for('reviews_write') }}">리뷰 등록</a></li>
          <li><a href="{{ url_for('products_enroll') }}">상품 등록</a></li>
          {% if session['id'] %}
          <li>
            <a href="{{ url_for('mypage_index') }}"
              ><b>{{ session['id'] }}님 반갑습니다!</b></a
            >
          </li>
          <li>
            <a href="/logout"> 로그아웃 </a>
          </li>
          {% else %}
          <li>
            <a href="{{ url_for('login') }}">회원가입/로그인</a>
          </li>
          {% endif %}
        </ul>
      </nav>
    </header>

    <div class="page">
      <section id="container">
        <div class="mypage-container">
          <h2 class="mypage-font">My Page</h2>

          <!--프로필-->
          <div class="edit-container">
            <div class="content-container3">
              <form action="{{ url_for('mypage_edit') }}" method="post" enctype="multipart/form-data">
                <div
                  style="
                    display: flex;
                    flex-direction: row;
                    align-items: center;
                    gap: 2rem;
                  "
                >
                  <img
                    src="{{
                            url_for('static', filename=user.profile_img)
                            if user and user.profile_img
                            else url_for('static', filename='image/myprofile/profile.svg')
                          }}"
                    alt="프로필 이미지"
                    class="profile-img"
                    id="profile-img"
                    />

                  <div>
                    <div style="display: flex; flex-direction: row; gap: 12px">
                      <div style=" margin: 0; padding-top: 15px; display: inline-block; font-weight: bold;"<label for="username">이름</label></div>
                      <input
                        type="text"
                        id="username"
                        name="username"
                        value="{{ username }}"
                        class="name-container"
                      />


                      <button type="button" id="imgBtn" class="icon-button">
                        <img
                          src="{{ url_for('static', filename='image/icon/image.svg') }}"
                          alt="갤러리 아이콘"
                        />
                      </button>
                      
                      <input type="file" id="imgInput" name="profile_img" accept="image/*" style="display: none;" />
                        <script>
                          document.getElementById('imgBtn').addEventListener('click', function () {
                            document.getElementById('imgInput').click();
                          });
                          // 파일 선택 + 프로필 적용
                          document.getElementById('imgInput').addEventListener('change', function (event) {
                            const file = event.target.files[0];
                            if (!file) return;
                            const url = URL.createObjectURL(file);

                            const profileImg = document.getElementById('profile-img');
                            profileImg.src = url;
                        });
                        </script>
                    </div>
                  </div>
                </div>
                <div style="margin-top: 2rem"></div>

                <div class="form-group">
                  <label for="id">아이디</label>
                  <input
                    type="text"
                    id="id"
                    name="id"
                    value="{{ user_id }}"
                    placeholder="ewha2025"
                    required
                    class="id-input"
                    readonly
                  />
                </div>

                <div class="form-group">
                  <label for="email">이메일</label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    value="{{ email }}"
                    placeholder="ewha@ewha.ac.kr"
                    required
                    class="form-input"
                  />
                </div>

                <div class="form-group">
                  <label for="number">전화번호</label>
                  <input
                    type="tel"
                    id="number"
                    name="number"
                    value="{{ number }}"
                    placeholder="010-1234-5678"
                    required
                    class="form-input"
                  />
                </div>

                <div class="form-group">
                  <label for="password">비밀번호</label>
                  <input
                    type="password"
                    id="password"
                    name="password"
                    value="{{ password }}"
                    placeholder="●●●●●●●"
                    required
                    class="form-input"
                  />
                </div>

                <div class="form-group">
                  <label for="checkpw">비밀번호 확인</label>
                  <input
                    type="password"
                    id="checkpw"
                    name="checkpw"
                    value="{{ checkpw }}"
                    placeholder="●●●●●●●"
                    required
                    class="form-input"
                  />
                </div>

                <button class="edit-btn" type="submit">수정</button>
              </form>
            </div>
          </div>
        </div>
      </section>
    </div>

    <footer><p>@cloud9</p></footer>

    <script>
      document.getElementById("edit-button").addEventListener("click", () => {
        window.location.href = "{{ url_for('mypage_edit') }}";
      });
    </script>
  </body>
</html>
