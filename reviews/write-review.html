<!--리뷰 작성 페이지-->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ewha Market | 리뷰 작성</title>
    <link rel="stylesheet" href="../styles/global.css" />
    <link rel="stylesheet" href="../styles/review.write.css" />
    <link rel="stylesheet" href="../styles/auth.css" />
  </head>

  <body>
    <header>
      <div class="logo">
        <img src="../assets/Market-logo.png" alt="Ewha Market" />
      </div>
      <nav>
        <ul class="nav-menu">
          <li><a href="../index.html">상품 조회</a></li>
          <li><a href="../reviews/index.html">리뷰 조회</a></li>
          <li>
            <a href="../reviews/write-review.html" class="active">리뷰 등록</a>
          </li>
          <li><a href="../products/enroll.html">상품 등록</a></li>
          <li><a href="../mypage/index.html">마이페이지</a></li>
          <li><a href="../auth/login.html">회원가입/로그인</a></li>
        </ul>
      </nav>
    </header>

    <main class="container">
      <div class="page">
        <section>
          <div class="review-container">
            <!-- 상단: 상품정보 + 파일업로드 -->
            <div class="top-section">
              <div class="product-info">
                <img
                  src="https://static.nike.com/a/images/t_PDP_1280_v1/f_auto,q_auto:eco/2f0c10b2-58f5-42f1-9c0a-293b146fe7db/superstar-82-shoes-3ZFtWb.png"
                  alt="제품 이미지"
                />
                <div class="product-text">
                  <b>아디다스 운동화</b>
                  <label> 구매일:</label>
                  <input
                    type="date"
                    class="input-field"
                    id="purchaseDate"
                  /><br />
                  <label> ID:</label>
                  <input
                    type="text"
                    class="input-field"
                    id="userId"
                    placeholder="아이디 입력"
                  />
                </div>
              </div>
              <div class="upload-area" id="fileUploadArea">
                <div class="upload-boxes">
                  <div class="upload-box">+</div>
                  <div>
                    <div class="upload-img"></div>
                    <div class="upload-img"></div>
                  </div>
                  <div>
                    <div class="upload-img"></div>
                    <div class="upload-img"></div>
                  </div>
                </div>
              </div>
            </div>

            <div
              style="
                display: flex;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                padding: 0 1.5rem;
              "
            >
              <div class="star-rating" id="starRating">
                <span>★</span><span>★</span><span>★</span><span>★</span
                ><span>★</span>
              </div>
              <button class="choose-file" id="chooseBtn">파일 선택</button>
            </div>

            <!-- 리뷰 입력 -->
            <input
              type="text"
              class="review-title"
              placeholder="리뷰 제목을 입력해 주세요!"
            />
            <textarea
              class="review-content"
              placeholder="상품은 어떠셨나요? 자세한 후기를 남겨 주세요."
            ></textarea>

            <button class="submit-btn">등록하기</button>
          </div>
        </section>
      </div>
    </main>

    <footer>@cloud9</footer>

    <script>
      // 별점 클릭 유지
      const stars = document.querySelectorAll("#starRating span");
      stars.forEach((star, index) => {
        star.addEventListener("click", () => {
          stars.forEach((s, i) => s.classList.toggle("active", i <= index));
        });
      });

      // 이미지 업로드 (파일 선택 + 미리보기)
      const uploadArea = document.getElementById("fileUploadArea");
      const chooseBtn = document.getElementById("chooseBtn");
      const maxFiles = 10;

      function createPreviewBox(file) {
        const reader = new FileReader();
        const box = document.createElement("div");
        box.classList.add("upload-box");
        reader.onload = (e) => {
          box.innerHTML = `<img src="${e.target.result}" alt="미리보기" />`;
        };
        reader.readAsDataURL(file);
        uploadArea.querySelector(".upload-boxes").appendChild(box);
      }

      function handleFiles(files) {
        const existing = uploadArea.querySelectorAll(".upload-box img").length;
        const remaining = maxFiles - existing;
        Array.from(files)
          .slice(0, remaining)
          .forEach((file) => {
            if (file.type.startsWith("image/")) createPreviewBox(file);
          });
      }

      chooseBtn.addEventListener("click", () => {
        const input = document.createElement("input");
        input.type = "file";
        input.accept = "image/*";
        input.multiple = true;
        input.onchange = (e) => handleFiles(e.target.files);
        input.click();
      });

      uploadArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        uploadArea.classList.add("dragover");
      });
      uploadArea.addEventListener("dragleave", () =>
        uploadArea.classList.remove("dragover")
      );
      uploadArea.addEventListener("drop", (e) => {
        e.preventDefault();
        uploadArea.classList.remove("dragover");
        handleFiles(e.dataTransfer.files);
      });
    </script>
  </body>
</html>
